#LyX 2.2 created this file. For more info see http://www.lyx.org/
\lyxformat 508
\begin_document
\begin_header
\save_transient_properties true
\origin unavailable
\textclass scrbook
\begin_preamble
% increases link area for cross-references and autoname them
% if you change the document language to e.g. French
% you must change "extrasenglish" to "extrasfrench"
\AtBeginDocument{%
 \renewcommand{\ref}[1]{\mbox{\autoref{#1}}}
}
\def\refnamechanges{%
 \renewcommand*{\equationautorefname}[1]{}
 \renewcommand{\sectionautorefname}{sec.\negthinspace}
 \renewcommand{\subsectionautorefname}{sec.\negthinspace}
 \renewcommand{\subsubsectionautorefname}{sec.\negthinspace}
 \renewcommand{\figureautorefname}{Fig.\negthinspace}
 \renewcommand{\tableautorefname}{Tab.\negthinspace}
}
\@ifpackageloaded{babel}{\addto\extrasenglish{\refnamechanges}}{\refnamechanges}

% in case somebody want to have the label "Equation"
%\renewcommand{\eqref}[1]{Equation~(\negthinspace\autoref{#1})}

% that links to image floats jumps to the beginning
% of the float and not to its caption
\usepackage[figure]{hypcap}

% the pages of the TOC is numbered roman
% and a pdf-bookmark for the TOC is added
\let\myTOC\tableofcontents
\renewcommand\tableofcontents{%
  \frontmatter
  \pdfbookmark[1]{\contentsname}{}
  \myTOC
  \mainmatter }

% makes caption labels bold
% for more info about these settings, see
% http://mirrors.ctan.org/macros/latex/contrib/koma-script/doc/scrguien.pdf
\setkomafont{captionlabel}{\bfseries}
\setcapindent{1em}

% enables calculations
\usepackage{calc}

% fancy page header/footer settings
% for more information see section 9 of
% ftp://www.ctan.org/pub/tex-archive/macros/latex2e/contrib/fancyhdr/fancyhdr.pdf
\renewcommand{\chaptermark}[1]{\markboth{#1}{#1}}
\renewcommand{\sectionmark}[1]{\markright{\thesection\ #1}}

% increases the bottom float placement fraction
\renewcommand{\bottomfraction}{0.5}

% avoids that floats are placed above its sections
\let\mySection\section\renewcommand{\section}{\suppressfloats[t]\mySection}
\end_preamble
\options intoc,bibliography=totoc,index=totoc,BCOR10mm,captions=tableheading,titlepage,fleqn
\use_default_options true
\master MasterThesisTemplate.lyx
\begin_modules
customHeadersFooters
\end_modules
\maintain_unincluded_children false
\language english
\language_package default
\inputencoding auto
\fontencoding global
\font_roman "lmodern" "default"
\font_sans "lmss" "default"
\font_typewriter "lmtt" "default"
\font_math "auto" "auto"
\font_default_family default
\use_non_tex_fonts false
\font_sc false
\font_osf false
\font_sf_scale 100 100
\font_tt_scale 100 100
\graphics default
\default_output_format default
\output_sync 0
\bibtex_command default
\index_command default
\float_placement h
\paperfontsize 12
\spacing single
\use_hyperref true
\pdf_title "Your title"
\pdf_author "Your name"
\pdf_bookmarks true
\pdf_bookmarksnumbered true
\pdf_bookmarksopen true
\pdf_bookmarksopenlevel 1
\pdf_breaklinks false
\pdf_pdfborder true
\pdf_colorlinks false
\pdf_backref false
\pdf_pdfusetitle false
\pdf_quoted_options "pdfpagelayout=OneColumn, pdfnewwindow=true, pdfstartview=XYZ, plainpages=false"
\papersize a4paper
\use_geometry false
\use_package amsmath 2
\use_package amssymb 2
\use_package cancel 1
\use_package esint 1
\use_package mathdots 1
\use_package mathtools 1
\use_package mhchem 1
\use_package stackrel 1
\use_package stmaryrd 1
\use_package undertilde 1
\cite_engine natbib
\cite_engine_type authoryear
\biblio_style plain
\use_bibtopic false
\use_indices false
\paperorientation portrait
\suppress_date false
\justification true
\use_refstyle 0
\branch NoChildDocument
\selected 0
\filename_suffix 0
\color #ff0000
\end_branch
\index Index
\shortcut idx
\color #008000
\end_index
\secnumdepth 3
\tocdepth 2
\paragraph_separation skip
\defskip medskip
\quotes_language english
\papercolumns 1
\papersides 2
\paperpagestyle fancy
\tracking_changes false
\output_changes false
\html_math_output 0
\html_css_as_file 0
\html_be_strict false
\end_header

\begin_body

\begin_layout Left Header
\begin_inset Argument 1
status open

\begin_layout Plain Layout
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
chaptername
\end_layout

\end_inset


\begin_inset space ~
\end_inset


\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
thechapter
\end_layout

\end_inset


\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
rightmark
\end_layout

\end_inset


\begin_inset Note Note
status collapsed

\begin_layout Plain Layout
Enable page headers and add the chapter to the header line.
\end_layout

\end_inset


\end_layout

\begin_layout Right Header
\begin_inset Argument 1
status open

\begin_layout Plain Layout
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
leftmark
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Left Footer
\begin_inset Argument 1
status open

\begin_layout Plain Layout
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
thepage
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Center Footer

\end_layout

\begin_layout Right Footer
\begin_inset Argument 1
status open

\begin_layout Plain Layout

\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
thepage
\end_layout

\end_inset


\end_layout

\begin_layout Chapter
Software
\end_layout

\begin_layout Standard
Both R and Python are powerful programming languages for data analysis.
 Python has been known as a general purpose language with an easy to understand
 syntax.
 It emphasizes on code readability and has a gentle learning curve.
 R is developed by and for statistician.
 It provides a huge number of essential packages in statistics, and even
 starts to expand to different fields.
 R also has a strong reputation for data visualization.
 However, in terms of computation, R still cannot compete with Python which
 is built specifically for the computer programming.
 With strengths and weaknesses between R and Python described earlier, R
 is chosen to be used in this study.
 R offers more implemented algorithms to solve the problem at hand.
 Moreover, an effective visualization helps analyst and user to understand
 more about their data especially for the complex one.
 Visualizing data is useful in many ways such as uncover new patterns, identify
 some factors, and get an overall trend.
 R proves itself a good choice since it provides a great feature in creating
 an interactive graphic and visualization.
\end_layout

\begin_layout Chapter
MSwM Package
\begin_inset CommandInset label
LatexCommand label
name "chap:MSwM-Package"

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Note Note
status open

\begin_layout Plain Layout
You may want to include an appendix to describe the software used in the
 thesis.
 You can also include CONCISE documentation of your own code.
 Do not include page up and down with code, but maybe a list of functions
 and objects, and a short description of what each function does and the
 properties of objects.
 Ideally, you could post your code online (github is a popular place) and
 link to it from here.
\end_layout

\end_inset


\end_layout

\begin_layout Standard
The algorithm used for fitting the Markov switching autoregressive model
 is mainly based on a 
\emph on
MSwM
\emph default
 package in R 
\begin_inset CommandInset citation
LatexCommand citep
key "mswm"

\end_inset

.
 This package performs an univariate autoregressive Markov switching model
 for linear and generalized models.
 The package implements the Expectation-Maximization (E-M) algorithm to
 fit the Markov switching model.
 
\end_layout

\begin_layout Standard
Code is further implemented and some modifications are made in the function
 to handle warnings and errors produced when fitting the model.
 These are described in more details here.
\end_layout

\begin_layout Paragraph*
Non-switching effect
\end_layout

\begin_layout Standard
When setting variance to have a non-switching effect, the function generates
 a warning.
 It proved that there is a minor mistake in the code.
 
\end_layout

\begin_layout Paragraph
Non-invertible Hessian
\end_layout

\begin_layout Standard
The package uses a Hessian, the matrix of second order partial derivatives
 with respect to parameters, for numerical optimization.
 In some cases, Hessian matrix will not be invertible as the matrix is singular.
 Consequently, the function can not compute standard error of estimated
 parameters.
 It is assumed that the singularity is coming from numerics issue i.e., the
 matrix is not singular but computationally it is.
 This non-invertible Hessian is solved by using generalized inverse (or
 pseudoinverse) procedure 
\begin_inset CommandInset citation
LatexCommand citep
key "gill2004your"

\end_inset

.
 
\end_layout

\begin_layout Paragraph*
Categorical variable
\end_layout

\begin_layout Standard
The package does not work properly well with categorical predictor variables.
 Hence, a further implementation in the code for handling with categorical
 variables is done.
 Factors are used to represent the categorical variables in R.
 Most of the time, the order of the factor does not matter.
 However, sometimes the order of the factor is of interest in the analysis
 and needs to be specified for comparison or meaningful interpretation.
 
\end_layout

\begin_layout Standard
\begin_inset Note Comment
status open

\begin_layout Plain Layout
There are reference level to be the highest occurrence
\end_layout

\end_inset


\end_layout

\begin_layout Paragraph*
NA coefficients
\end_layout

\begin_layout Standard
When performing the Markov switching model, the function in the package
 first randomly divides the data into different subsets and separately fit
 the model to get initial coefficients in each state.
 These coefficients are later used for further analysis e.g., computing condition
 means, error and likelihood for each state.
\end_layout

\begin_layout Standard
It is worth noting that the function computes conditional means for each
 state by using matrix multiplication 
\begin_inset Formula $\ensuremath{\hat{y}=X\hat{\beta}}$
\end_inset

.
 Therefore, if NAs exist in the coefficient matrix 
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none

\begin_inset Formula $\hat{\beta}$
\end_inset


\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\uuline default
\uwave default
\noun default
\color inherit
, these conditional means will also become NAs.
 
\end_layout

\begin_layout Standard
Due to the randomness in partitioning the data, sometimes a variable in
 a subset will have the same value in all observations.
 Then, NA coefficient is generated for this specific variable because of
 singularity.
 This NA coefficient issue occurs more frequently with a categorical variable
 as each categorical variable has its own number of levels.
 It is rather difficult for every subset to contain all levels of the variable
 especially if the variable contains several number of levels or many states
 are specified.
 For this reason, the missing level of the variable in any subset will have
 an NA coefficient.
 
\end_layout

\begin_layout Standard
One approach to resolve this issue is by removing the process of partitioning
 the data in the beginning, and fitting the model with the whole data to
 get the initial coefficients instead.
 The parameters in each state will then have the same coefficient values.
 It proved that dividing data into subsets is only a method to get the starting
 values for coefficients in each state and does not have much effect for
 the algorithm.
 
\end_layout

\begin_layout Paragraph
Predict function
\end_layout

\begin_layout Standard
The implementation for the model prediction is added in the package.
 This function predicts the most probable state that a new observation will
 belong to.
 The input of the predict function is the training model and the new set
 of data.
 The function computes the filtered probabilities or the Equation 
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:fProb"

\end_inset

.
 The output from the function is the state for the new observation which
 has the highest probability.
\end_layout

\begin_layout Chapter
Output 
\begin_inset CommandInset label
LatexCommand label
name "chap:Output"

\end_inset


\end_layout

\begin_layout Standard
L16A_YN
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout
\noindent
\align center
\begin_inset Graphics
	filename picture/L16B_NNY.png
	lyxscale 50
	scale 35

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Model 2: L16B_NNY
\end_layout

\end_inset


\begin_inset CommandInset label
LatexCommand label
name "L16B_NNY"

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\noindent
\align center
\begin_inset Graphics
	filename picture/L16B_YNY.png
	lyxscale 50
	scale 35

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Model 6: L16B_YNY
\end_layout

\end_inset


\begin_inset CommandInset label
LatexCommand label
name "L16B_YNY"

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard

\end_layout

\begin_layout Standard
\begin_inset Branch NoChildDocument
status collapsed

\begin_layout Standard
\begin_inset CommandInset bibtex
LatexCommand bibtex
bibfiles "biblio/Plasma"
options "biblio/alpha"

\end_inset


\end_layout

\begin_layout Standard
\begin_inset CommandInset nomencl_print
LatexCommand printnomenclature
set_width "custom"
width "2.5cm"

\end_inset


\end_layout

\end_inset


\end_layout

\end_body
\end_document
